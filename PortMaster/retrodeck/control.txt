#!/bin/bash

if [ -d "${HOME}/.var/app/net.retrodeck.retrodeck/config/retrodeck/" ]; then
  controlfolder=$(grep 'roms_folder' "${HOME}/.var/app/net.retrodeck.retrodeck/config/retrodeck/retrodeck.cfg" | awk -F= '{print $2}')"/ports/PortMaster"
fi


export SDL_GAMECONTROLLERCONFIG_FILE="/usr/lib/gamecontrollerdb.txt"

get_controls() {
  ANALOGSTICKS="2"
  LOWRES="N"
}

# CRUSH KILL DESTROY
if [ -f "$controlfolder/gptokeyb.x86_64" ]; then
  mv "$controlfolder/gptokeyb.x86_64" "$controlfolder/gptokeyb"
fi

if [ -f "$controlfolder/gptokeyb2.armhf" ]; then
  mv "$controlfolder/gptokeyb2.armhf" "$controlfolder/gptokeyb2"
fi

# CRUSH KILL DESTROY
if [ -f "$controlfolder/xdelta3.x86_64" ]; then
  mv "$controlfolder/xdelta3.x86_64" "$controlfolder/xdelta3"
fi

if [ -f "$controlfolder/cwtbe_flag" ]; then
  GPTOKEYB="$controlfolder/gptokeyb2 $ESUDOKILL"
else
  GPTOKEYB="$controlfolder/gptokeyb $ESUDOKILL"
fi
